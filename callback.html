<!DOCTYPE html>
<html>
<head>
  <title>Logging you in...</title>
</head>
<body>
  <h2>Logging you in...</h2>

  <script>
    const hash = window.location.hash;
    const params = new URLSearchParams(hash.substring(1));
    const idToken = params.get("id_token");

    if (!idToken) {
      document.body.innerHTML = "<h3>Login failed</h3>";
      throw new Error("No token received");
    }

    // Decode JWT
    const payload = JSON.parse(atob(idToken.split('.')[1]));
    console.log("Token payload:", payload);

    const groups = payload["cognito:groups"];

    // Save token
    localStorage.setItem("id_token", idToken);

    // âœ… MATCH EXACT GROUP NAMES
    if (groups && groups.includes("Admin")) {
      window.location.href = "admin-dashboard.html";
    } else if (groups && groups.includes("User")) {
      window.location.href = "student-dashboard.html";
    } else {
      // fallback
      window.location.href = "user-dashboard.html";
    }
  </script>
</body>
</html>

